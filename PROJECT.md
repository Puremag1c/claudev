# Claudev ‚Äî Project Context

## –ß—Ç–æ —ç—Ç–æ –∑–∞ –ø—Ä–æ–µ–∫—Ç

**Claudev** ‚Äî –º–Ω–æ–≥–æ–∞–≥–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ –±–∞–∑–µ Claude Code.

–°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –ø—Ä–æ–µ–∫—Ç–∞: –º–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞, –∫–æ–¥–µ—Ä–æ–≤, —Ä–µ–≤—å—é–µ—Ä–æ–≤ –∏ –ø–æ–º–æ—â–Ω–∏–∫–æ–≤. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Beads, —Ä–∞–±–æ—Ç–∞ –∏–¥—ë—Ç —á–µ—Ä–µ–∑ bash orchestrator.

## –¶–µ–ª—å

–°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –ª—é–±–æ–π –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ `git clone`.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
claudev/
‚îú‚îÄ‚îÄ CLAUDE.md              # –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç (–ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏)
‚îú‚îÄ‚îÄ PROJECT.md             # ‚Üê –≠—Ç–æ—Ç —Ñ–∞–π–ª (–∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞)
‚îú‚îÄ‚îÄ core/                  # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ agents/            # –®–∞–±–ª–æ–Ω—ã –∞–≥–µ–Ω—Ç–æ–≤ (manager, architect, coder...)
‚îÇ   ‚îú‚îÄ‚îÄ commands/          # Slash-–∫–æ–º–∞–Ω–¥—ã (/start, /status)
‚îÇ   ‚îî‚îÄ‚îÄ scripts/           # Bash —Å–∫—Ä–∏–ø—Ç—ã (orchestrator, claim-task...)
‚îú‚îÄ‚îÄ templates/             # –®–∞–±–ª–æ–Ω—ã –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ SPEC.template.md   # –®–∞–±–ª–æ–Ω —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ CLAUDE.template.md # –®–∞–±–ª–æ–Ω CLAUDE.md –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ install.sh             # –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ–µ–∫—Ç
‚îî‚îÄ‚îÄ docs/                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îî‚îÄ‚îÄ architecture.md    # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
```

## –í–ê–ñ–ù–û: –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏ –∞–≥–µ–Ω—Ç–æ–≤

–§–∞–π–ª—ã –≤ `core/agents/*.md` ‚Äî —ç—Ç–æ **–ö–û–î –ü–†–û–ï–ö–¢–ê**, –∞ –Ω–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ Claude.

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ –Ω–∞–¥ claudev —è —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—é —ç—Ç–∏ —Ñ–∞–π–ª—ã –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥. –û–Ω–∏ —Å—Ç–∞–Ω—É—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ–µ–∫—Ç –∏ –∑–∞–ø—É—â–µ–Ω–∞ —á–µ—Ä–µ–∑ orchestrator.

## –ö–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç

```bash
# –í —Ü–µ–ª–µ–≤–æ–º –ø—Ä–æ–µ–∫—Ç–µ:
git clone git@github.com:user/claudev.git .claudev
.claudev/install.sh

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
target-project/
‚îú‚îÄ‚îÄ .claudev/              # –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —è–¥—Ä–æ
‚îú‚îÄ‚îÄ .claude/               # –°–∏–º–ª–∏–Ω–∫–∏ –Ω–∞ agents –∏ commands
‚îÇ   ‚îú‚îÄ‚îÄ agents -> ../.claudev/core/agents
‚îÇ   ‚îî‚îÄ‚îÄ commands -> ../.claudev/core/commands
‚îú‚îÄ‚îÄ scripts -> .claudev/core/scripts
‚îú‚îÄ‚îÄ SPEC.md                # –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (–∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
‚îî‚îÄ‚îÄ CLAUDE.md              # Project instructions
```

## –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### –ê–≥–µ–Ω—Ç—ã (core/agents/)

| –ê–≥–µ–Ω—Ç | –ú–æ–¥–µ–ª—å | –†–æ–ª—å |
|-------|--------|------|
| manager | Sonnet | Stateless –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ–∞–∑—É –ø–æ beads, –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ |
| tech-writer | Opus | –°–æ–±–∏—Ä–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç SPEC.md |
| architect | Opus | –°–æ–∑–¥–∞—ë—Ç –ø–ª–∞–Ω, –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –º–æ–¥–µ–ª–∏ –∑–∞–¥–∞—á–∞–º, —Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ—Ç dependencies |
| analyst-ux | Sonnet | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç UX, –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ (—Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è–µ—Ç, –Ω–µ —É–¥–∞–ª—è–µ—Ç) |
| analyst-security | Sonnet | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ |
| analyst-ops | Sonnet | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã, –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ |
| analyst-reliability | Sonnet | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å, edge cases, –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ |
| analyst-architecture | Sonnet | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ |
| executor | –ü–æ –∑–∞–¥–∞—á–µ | –†–µ–∞–ª–∏–∑—É–µ—Ç –û–î–ù–£ –∑–∞–¥–∞—á—É, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å–≤–æ–µ–π git –≤–µ—Ç–∫–µ |
| senior-executor | Opus | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫–æ–¥, –º–µ—Ä–∂–∏—Ç –≤ main |

### –§–æ—Ä–º–∞—Ç –ø—Ä–æ–º–ø—Ç–æ–≤ –∞–≥–µ–Ω—Ç–æ–≤

–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª –∞–≥–µ–Ω—Ç–∞ (`core/agents/*.md`) —Å–æ–¥–µ—Ä–∂–∏—Ç:

```markdown
---
name: agent-name
description: –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–æ–ª–∏
model: opus|sonnet|haiku
---

# –†–æ–ª—å: –ù–∞–∑–≤–∞–Ω–∏–µ

–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∞–≥–µ–Ω—Ç.

## –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ê–í–ò–õ–ê
- –ß—Ç–æ –ù–ò–ö–û–ì–î–ê –Ω–µ –¥–µ–ª–∞—Ç—å
- –ß—Ç–æ –í–°–ï–ì–î–ê –¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—ã–º

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã
1. –ü–µ—Ä–≤—ã–π —à–∞–≥ (—Å –ø—Ä–∏–º–µ—Ä–æ–º –∫–æ–º–∞–Ω–¥—ã)
2. –í—Ç–æ—Ä–æ–π —à–∞–≥
3. ...

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- `bd` –∫–æ–º–∞–Ω–¥—ã –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç
- `git` –æ–ø–µ—Ä–∞—Ü–∏–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω—ã
- –î—Ä—É–≥–∏–µ —Å–∫—Ä–∏–ø—Ç—ã

## –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
- –ö–∞–∫ –∞–≥–µ–Ω—Ç –ø–æ–Ω–∏–º–∞–µ—Ç —á—Ç–æ –∑–∞–∫–æ–Ω—á–∏–ª
- –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –≤ –∫–æ–Ω—Ü–µ (close –∑–∞–¥–∞—á–∏, log, etc.)
```

**–ü—Ä–∏–Ω—Ü–∏–ø—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è LLM:**
- –ü—Ä–æ—Å—Ç—ã–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (–æ–¥–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è = –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞)
- –Ø–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã —Å `bd create`, `bd close`, `git commit`
- –ß—ë—Ç–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- –ú–∏–Ω–∏–º—É–º —É—Å–ª–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏ (if/else)

### –°–∫—Ä–∏–ø—Ç—ã (core/scripts/)

| –°–∫—Ä–∏–ø—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------------|
| orchestrator.sh | –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª, –ø–∏–Ω–≥—É–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∫–∞–∂–¥—ã–µ N —Å–µ–∫—É–Ω–¥ |
| detect-phase.sh | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ñ–∞–∑—ã –ø—Ä–æ–µ–∫—Ç–∞ |
| run-analysts.sh | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ 5 analysts |
| run-executors.sh | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ executors (–¥–æ MAX_PARALLEL) |
| log.sh | –•–µ–ª–ø–µ—Ä –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ logs/claudev.log |

**–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ (—É–¥–∞–ª–∏—Ç—å):**
- claim-task.sh ‚Äî –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ `bd update <id> --claim`
- init-manager.sh ‚Äî Manager stateless, –Ω–µ –Ω—É–∂–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
| run-helpers.sh | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø–æ–º–æ—â–Ω–∏–∫–æ–≤ |
| run-coders.sh | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –∫–æ–¥–µ—Ä–æ–≤ |

### –§–∞–∑—ã –ø—Ä–æ–µ–∫—Ç–∞

```
INIT ‚Üí PLANNING ‚Üí HELPERS ‚Üí PLAN_REVIEW ‚Üí IMPLEMENTATION ‚Üí FINAL_REVIEW ‚Üí DONE
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **Beads** ‚Äî —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ (bd CLI)
- **Claude Code** ‚Äî CLI –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤
- **Bash** ‚Äî –¥–ª—è orchestrator –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤

## –ö–ª—é—á–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
- –ù–µ–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —á—ë—Ç–∫–æ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã
- –û—Ç —Å–ª–æ–≤–µ—Å–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è ‚Üí –∫ –≥–æ—Ç–æ–≤–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Å–∏—Å—Ç–µ–º—ã
- **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å** ‚Äî –Ω–µ copilot, –∞ –æ—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ—Å—Ç—å** ‚Äî MVP ‚Üí –¥–æ—Ä–∞–±–æ—Ç–∫–∞ ‚Üí –¥–æ—Ä–∞–±–æ—Ç–∫–∞ (–Ω–µ overthinking)
- **–ö–æ—Ä–æ—Ç–∫–∏–µ –∑–∞–¥–∞—á–∏** ‚Äî –∫–∞–∂–¥—ã–π task –≤ beads = 1-5 –º–∏–Ω—É—Ç Sonnet
- **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** ‚Äî –≤—Å—ë –≤ Beads, –ª—é–±–æ–π –≤–æ—Ä–∫–µ—Ä –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å

### –ü–∞–π–ø–ª–∞–π–Ω —Ä–æ–ª–µ–π
```
Vision (–∑–∞–∫–∞–∑—á–∏–∫)
    ‚Üì
Tech Writer (—Å–æ–±–∏—Ä–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –¢–ó + config)
    ‚Üì
Architect (–ø–ª–∞–Ω, —Ä–∞–∑–±–∏–≤–∫–∞ –Ω–∞ –∑–∞–¥–∞—á–∏, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
    ‚Üì
Analysts (UX / Security / OPS / Reliability / Architecture)
    ‚Üì
Architect (–¥–æ—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞–Ω–∞ –ø–æ feedback –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤)
    ‚Üì
Executors (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á)
    ‚Üì
Senior Executor (–∫–æ–¥ —Ä–µ–≤—å—é, merge, —Ä–µ–ª–∏–∑)
    ‚Üì
Architect (FINAL_REVIEW ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏)
    ‚Üì
CI/CD GitHub (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–º
- Manager –≤ —Ü–∏–∫–ª–µ (–ø–æ–∫–∞ –Ω–µ—Ç –ª—É—á—à–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è)
- –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–¥–µ–Ω–∏—è–º–∏ (–∑–∞–¥–∞—á–∞ > 10 –º–∏–Ω = –ø—Ä–æ–±–ª–µ–º–∞)
- Beads –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã

---

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

**–°—Ç–∞—Ç—É—Å:** –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞—É–¥–∏—Ç –ø—Ä–æ–π–¥–µ–Ω (2 –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è, 19 —É–≥—Ä–æ–∑ –Ω–∞–π–¥–µ–Ω–æ –∏ –∑–∞–∫—Ä—ã—Ç–æ)

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞—É–¥–∏—Ç:**
- ‚úÖ –ü–µ—Ä–≤–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ (23 —è–Ω–≤–∞—Ä—è): 10 —É–≥—Ä–æ–∑ ‚Üí —Ä–µ—à–µ–Ω–∏—è #11-#20
- ‚úÖ –í—Ç–æ—Ä–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ (24 —è–Ω–≤–∞—Ä—è): 9 —É–≥—Ä–æ–∑ ‚Üí —Ä–µ—à–µ–Ω–∏—è #21-#25
- ‚ö†Ô∏è 2 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –±–ª–æ–∫–µ—Ä–∞ (P0): [claudev-czh](claudev-czh), [claudev-acs](claudev-acs)
- üìã 2 –≤–∞–∂–Ω—ã—Ö –¥–æ—Ä–∞–±–æ—Ç–∫–∏ (P1): [claudev-ssb](claudev-ssb), [claudev-h03](claudev-h03)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- [x] core/ ‚Äî –∞–≥–µ–Ω—Ç—ã, –∫–æ–º–∞–Ω–¥—ã, —Å–∫—Ä–∏–ø—Ç—ã (—Ç—Ä–µ–±—É—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
- [x] templates/ ‚Äî —à–∞–±–ª–æ–Ω—ã SPEC.md –∏ CLAUDE.md
- [x] install.sh ‚Äî —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ (—Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è + dependency check)
- [x] docs/ ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–∫—Ä—ã—Ç—å 2 P0 –∑–∞–¥–∞—á–∏ ‚Üí –≥–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. P1 –∑–∞–¥–∞—á–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã.

**–û–±—Å—É–∂–¥–µ–Ω–æ (22 —è–Ω–≤–∞—Ä—è 2026):**
- ‚úÖ Tech Writer ‚Äî Opus, —Å–∞–º –ø–∏—à–µ—Ç –≤ beads, —Ä–µ–∂–∏–º—ã (–Ω–æ–≤—ã–π/–∏—Ç–µ—Ä–∞—Ü–∏—è)
- ‚úÖ Manager ‚Äî Sonnet, stateless, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ–∞–∑—É –ø–æ beads
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî subagents + beads, –∫–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç —Å–∞–º –ø–∏—à–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- ‚úÖ –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å ‚Äî retry 3x, —ç—Å–∫–∞–ª–∞—Ü–∏—è –∫ Architect, –ª–∏–º–∏—Ç 2
- ‚úÖ **Timeout enforcement:**
  - Orchestrator –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ `timeout 10m claude -p "..."`
  - –ü—Ä–∏ —Ç–∞–π–º–∞—É—Ç–µ: –ø—Ä–æ—Ü–µ—Å—Å —É–±–∏–≤–∞–µ—Ç—Å—è, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, retry counter++
  - Retry history —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ notes –∑–∞–¥–∞—á–∏:
    ```
    retry 1: 2026-01-23 15:30 - timeout
    retry 2: 2026-01-23 15:45 - timeout
    ```
  - –ü–æ—Å–ª–µ 3 retry ‚Üí —ç—Å–∫–∞–ª–∞—Ü–∏—è –∫ Architect
- ‚úÖ UX ‚Äî 4 —Å—Ç–∞—Ç—É—Å–∞, –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è user, clarification vs decision
- ‚úÖ –ò—Ç–µ—Ä–∞—Ü–∏–∏ ‚Äî SPEC.md —Å —Å–µ–∫—Ü–∏—è–º–∏ Iteration N

**–û–±—Å—É–∂–¥–µ–Ω–æ (23 —è–Ω–≤–∞—Ä—è 2026):**
- ‚úÖ Senior Analyst ‚Äî —É–±—Ä–∞–Ω, –∏–∑–±—ã—Ç–æ—á–µ–Ω
- ‚úÖ –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –º–µ–∂–¥—É –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º–∏ ‚Äî —Ä–µ—à–∞–µ—Ç Architect
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: Security > UX (–∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –º–µ—Ä—ã —É–±–∏—Ä–∞–µ–º –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏)
- ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∏ —Ç–æ–ª—å–∫–æ –î–û–ë–ê–í–õ–Ø–Æ–¢ –∑–∞–¥–∞—á–∏, Architect –º–æ–∂–µ—Ç –£–î–ê–õ–Ø–¢–¨ (–¥—É–±–ª–∏–∫–∞—Ç—ã, –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å)
- ‚úÖ Manager ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏, Architect –Ω–µ –∂–¥—ë—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤ —Å–∞–º
- ‚úÖ –§–æ—Ä–º–∞—Ç –∑–∞–¥–∞—á–∏ –≤ beads –¥–ª—è Executor:
  ```
  title: –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
  files: –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Ç—Ä–æ–≥–∞—Ç—å (1-3)
  done_when: —á—ë—Ç–∫–∏–π –∫—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
  ```
- ‚úÖ –ì—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á ‚Äî —ç–≤—Ä–∏—Å—Ç–∏–∫–∞: "–µ—Å–ª–∏ –µ—Å—Ç—å '–∏' ‚Äî —ç—Ç–æ 2 –∑–∞–¥–∞—á–∏", "–±–æ–ª—å—à–µ 3 —Ñ–∞–π–ª–æ–≤ ‚Äî —Ä–∞–∑–±–µ–π"

- ‚úÖ Analysts ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º –≤—Å–µ—Ö 5 (UX, Security, OPS, Reliability, Architecture). –î—ë—à–µ–≤–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å, –¥–æ—Ä–æ–≥–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ—à–∏–±–∫–∏.

- ‚úÖ **Executors ‚Äî git workflow:**
  - Architect –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –º–æ–¥–µ–ª—å (haiku/sonnet/opus) –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
  - Architect —Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ—Ç dependencies –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
  - Executor —Å–æ–∑–¥–∞—ë—Ç –≤–µ—Ç–∫—É `task/beads-xxx`, —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–º–º–∏—Ç–∏—Ç
  - Executor –ø–æ–º–µ—á–∞–µ—Ç –∑–∞–¥–∞—á—É done ‚Üí —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–≤–∏—Å–∏–º—ã–µ
  - **–ö–†–ò–¢–ò–ß–ù–û:** –ó–∞—Ö–≤–∞—Ç –∑–∞–¥–∞—á–∏ –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ `bd update <id> --claim`
  - ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ: bd CLI –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å (fails if already claimed)
  - Race condition –º–µ–∂–¥—É Executors –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω

- ‚úÖ **Senior Executor (Opus):**
  - –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ ‚Äî quality gate –ø–µ—Ä–µ–¥ merge
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥, –º–µ—Ä–∂–∏—Ç —á–µ—Ä–µ–∑ PR (–Ω–µ –ª–æ–∫–∞–ª—å–Ω—ã–π merge):
    - `gh pr create` –∏–∑ task/beads-xxx –≤ main
    - `gh pr merge --squash` –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
    - GitHub –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å, –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ PR –æ—Å—Ç–∞—ë—Ç—Å—è open
  - –ü–æ—Å–ª–µ merge ‚Äî cleanup –≤–µ—Ç–æ–∫:
    - `git push origin --delete task/beads-xxx`
    - `git branch -d task/beads-xxx`
  - Merge conflict ‚Äî —Å–∞–º —Ä–µ—à–∞–µ—Ç, –º–∞–∫—Å–∏–º—É–º —ç—Å–∫–∞–ª–∏—Ä—É–µ—Ç –∫ Architect
  - –ï—Å–ª–∏ –∫–æ–¥ –ø–ª–æ—Ö–æ–π ‚Äî –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á—É, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤ `bd ready` (–º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å, –æ–±–Ω–æ–≤–ª—è–µ—Ç description —Å –ø—Ä–∏—á–∏–Ω–æ–π)

- ‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Architect –≤–∫–ª—é—á–∞–µ—Ç —Ç–µ—Å—Ç—ã –≤ –∑–∞–¥–∞—á—É. "–°–¥–µ–ª–∞–π X + –Ω–∞–ø–∏—à–∏ —Ç–µ—Å—Ç" ‚Äî Executor –≤–∏–¥–∏—Ç —ç—Ç–æ –≤ `done_when`.

- ‚úÖ **–°—Ç–∞—Ä—Ç —Å–∏—Å—Ç–µ–º—ã (–≥–∏–±—Ä–∏–¥):**
  - –ï—Å–ª–∏ SPEC.md –µ—Å—Ç—å ‚Üí Manager —Å—Ä–∞–∑—É –∫ Architect
  - –ï—Å–ª–∏ SPEC.md –Ω–µ—Ç ‚Üí Manager –∑–∞–ø—É—Å–∫–∞–µ—Ç Tech Writer
  - Tech Writer –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Üí —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç SPEC.md ‚Üí –ø–æ—Ç–æ–º Architect

- ‚úÖ **–§–∏–Ω–∏—à —Å–∏—Å—Ç–µ–º—ã:**
  - Manager –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: `bd list --status=open` = 0 (–≤—Å–µ –∑–∞–¥–∞—á–∏ closed)
  - –ï—Å–ª–∏ –¥–∞ ‚Üí —Ñ–∞–∑–∞ DONE, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –ª–æ–≥–µ
  - –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –í–°–ï –∑–∞–¥–∞—á–∏, –≤–∫–ª—é—á–∞—è –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ Analysts

- ‚úÖ **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º:**
  - Terminal prompt (stdin/stdout)
  - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å ‚Äî –≤–æ–ø—Ä–æ—Å ‚Üí –æ—Ç–≤–µ—Ç ‚Üí –≤–æ–∑–º–æ–∂–Ω—ã —É—Ç–æ—á–Ω–µ–Ω–∏—è
  - –°–∏—Å—Ç–µ–º–∞ –ø–∞—É–∑–∏—Ç –ø–æ–∫–∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç –æ—Ç–≤–µ—Ç

- ‚úÖ **MVP scope:** Tech Writer —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç "—á—Ç–æ –º–∏–Ω–∏–º—É–º –Ω—É–∂–Ω–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞?"

- ‚úÖ **–°—Ç–µ–∫ –∏ —è–∑—ã–∫:** Architect –≤—ã–±–∏—Ä–∞–µ—Ç, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –≤ –¢–ó –Ω–∞ —ç—Ç–∞–ø–µ Tech Writer

- ‚úÖ **CI/CD ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (GitHub Actions):**
  - **CI –µ—Å—Ç—å:** Senior Executor –ø–æ—Å–ª–µ merge –∂–¥—ë—Ç CI (`gh run watch`), CI failed ‚Üí bug issue
  - **CI –Ω–µ—Ç:** Senior Executor –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–¥ + —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ
  - **CD –µ—Å—Ç—å:** —Ä–µ–ª–∏–∑ —á–µ—Ä–µ–∑ `gh release create`
  - **CD –Ω–µ—Ç:** —Ä–µ–ª–∏–∑ = merge –≤ main + git tag

- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å Executors:**
  - –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `MAX_PARALLEL_EXECUTORS` (default: 3)
  - Architect –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤ SPEC.md –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ/–º–µ–Ω—å—à–µ

- ‚úÖ **–ë—é–¥–∂–µ—Ç:**
  - –†–∞—Å—Å—á–∏—Ç–∞–Ω–æ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É MAX ($200/–º–µ—Å)
  - ~2.5-3M —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é ‚Äî —É–∫–ª–∞–¥—ã–≤–∞–µ–º—Å—è —Å –∑–∞–ø–∞—Å–æ–º
  - –õ–æ–≥–∏—Ä—É–µ–º —Ä–∞—Å—Ö–æ–¥ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (–≤ –±—É–¥—É—â–µ–º)

- ‚úÖ **Quality gate (Senior Executor –ø—Ä–æ–≤–µ—Ä—è–µ—Ç):**
  - –ö–æ–¥ —Ä–µ–≤—å—é (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  - –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –ª–æ–∫–∞–ª—å–Ω–æ)
  - –õ–∏–Ω—Ç–∏–Ω–≥ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
  - –ü–æ–∫—Ä—ã—Ç–∏–µ –Ω–µ —É–ø–∞–ª–æ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
  - CI green (–µ—Å–ª–∏ CI –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
  - –°–±–æ—Ä–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (–µ—Å–ª–∏ CD –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–¥–µ—Ç–∞–ª—å–Ω–æ):**

  **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
  - –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥: `logs/claudev.log` ‚Äî –≤—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
  - –†–æ—Ç–∞—Ü–∏—è –ø–æ –∏—Ç–µ—Ä–∞—Ü–∏–∏: `mv logs/claudev.log logs/archive/iteration-N.log` (–∞—Ç–æ–º–∞—Ä–Ω–æ)
  - Race condition safe: `log.sh` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `>>` (append), —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π —Ñ–∞–π–ª –µ—Å–ª–∏ —Å—Ç–∞—Ä—ã–π –ø–µ—Ä–µ–º–µ—â—ë–Ω

  **–§–æ—Ä–º–∞—Ç (plaintext, —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π):**
  ```
  2026-01-23 15:30:45 [AGENT] EVENT: –æ–ø–∏—Å–∞–Ω–∏–µ
  2026-01-23 15:30:45 [MANAGER] PHASE: IMPLEMENTATION
  2026-01-23 15:30:46 [EXECUTOR] TASK_START: claudev-abc "–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É"
  2026-01-23 15:35:12 [EXECUTOR] TASK_DONE: claudev-abc
  2026-01-23 15:35:13 [EXECUTOR] ERROR: git push failed - remote rejected
  ```

  **–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):**
  - –°—Ç–∞—Ä—Ç/—Ñ–∏–Ω–∏—à –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
  - –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Ñ–∞–∑–∞–º–∏ (INIT ‚Üí PLANNING ‚Üí ...)
  - –ó–∞–¥–∞—á–∏: –≤–∑—è–ª (TASK_START), –∑–∞–≤–µ—Ä—à–∏–ª (TASK_DONE), –≤–µ—Ä–Ω—É–ª (TASK_RETURNED)
  - Git –æ–ø–µ—Ä–∞—Ü–∏–∏: commit, merge, revert, push
  - –í—Å–µ –æ—à–∏–±–∫–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (ERROR: —á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å)
  - –†–µ—à–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤ (DECISION: –ø–æ—á–µ–º—É –≤—ã–±—Ä–∞–ª X)

  **–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞—Å—Ö–æ–¥–∞):**
  - –¢–æ–∫–µ–Ω—ã: `TOKENS: input=1234 output=567 total=1801`
  - –í–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `config.yaml: log_tokens: true`

  **–•–µ–ª–ø–µ—Ä –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤:**
  ```bash
  # core/scripts/log.sh
  log() {
    local agent=$1 event=$2 message=$3
    echo "$(date '+%Y-%m-%d %H:%M:%S') [$agent] $event: $message" >> logs/claudev.log
  }
  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: log "MANAGER" "PHASE" "IMPLEMENTATION"
  ```

  **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ª–æ–≥–æ–≤:**
  - –ù–ò–ö–û–ì–î–ê –Ω–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å: –ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã API, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ .env
  - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ ID –∑–∞–¥–∞—á, –Ω–µ –ø–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ

- ‚úÖ **–†–µ–ª–∏–∑–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å (–ø–æ—Å–ª–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏):**
  - Manager –≤–∏–¥–∏—Ç: –≤—Å–µ –∑–∞–¥–∞—á–∏ closed (+ CI green –µ—Å–ª–∏ CI –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
  - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–∏–ø –≤–µ—Ä—Å–∏–∏: bugfix‚Üípatch, feature‚Üíminor, breaking‚Üímajor
  - –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è version –≤ package.json / mix.exs / etc.
  - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è CHANGELOG.md –∏–∑ closed –∑–∞–¥–∞—á –∏—Ç–µ—Ä–∞—Ü–∏–∏
  - –°–æ–∑–¥–∞—ë—Ç—Å—è git tag
  - **–ï—Å–ª–∏ CD –Ω–∞—Å—Ç—Ä–æ–µ–Ω:** `gh release create` —Å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏
  - **–ï—Å–ª–∏ CD –Ω–µ—Ç:** –∏—Ç–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, tag –≤ main

- ‚úÖ **Secrets –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (—Å—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å):**
  - `.gitignore`: .env, .env.*, *.pem, *.key, credentials.*, secrets/
  - Pre-commit hook: `gitleaks protect --staged` (install.sh –¥–æ–±–∞–≤–ª—è–µ—Ç)
  - –î–ª—è —Ç–µ—Å—Ç–æ–≤ ‚Äî mocks, –Ω–µ —Ä–µ–∞–ª—å–Ω—ã–µ API
  - CI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GitHub Secrets (–∞–≥–µ–Ω—Ç—ã –∏—Ö –Ω–µ –≤–∏–¥—è—Ç)
  - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∞–≥–µ–Ω—Ç–∞–º: "–ù–ò–ö–û–ì–î–ê –Ω–µ —á–∏—Ç–∞–π .env, –Ω–µ –ª–æ–≥–∏—Ä—É–π secrets, –Ω–µ –ø–∏—à–∏ secrets –≤ beads"
  - Senior Executor –ø—Ä–æ–≤–µ—Ä—è–µ—Ç diff –Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω—ã: sk-, api_key=, password=
  - **–û—Å—Ç–∞—Ç–æ—á–Ω—ã–π —Ä–∏—Å–∫:** –∞–≥–µ–Ω—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å .env ‚Äî –º–∏—Ç–∏–≥–∏—Ä—É–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
  - **Pre-commit hook fail:** –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º, —Å—á–∏—Ç–∞–µ–º –∫–∞–∫ –æ–±—ã—á–Ω—ã–π fail ‚Üí retry ‚Üí —ç—Å–∫–∞–ª–∞—Ü–∏—è –∫ Architect

- ‚úÖ **Merge conflicts:**
  - –ü—Ä–æ—Å—Ç–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç (—Ä–∞–∑–Ω—ã–µ –º–µ—Å—Ç–∞) ‚Äî Senior Executor —Ä–µ—à–∞–µ—Ç —Å–∞–º
  - –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π (–æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è) ‚Äî –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç merge, —Å–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á—É –¥–ª—è Architect
  - Architect —Ä–µ—à–∞–µ—Ç: –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∏–ª–∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å

- ‚úÖ **Rollback –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø–æ—Å–ª–µ merge:**
  - **–ï—Å–ª–∏ CI –µ—Å—Ç—å –∏ —É–ø–∞–ª:** Senior Executor –¥–µ–ª–∞–µ—Ç `git revert`, –∑–∞–¥–∞—á–∞ ‚Üí open —Å "CI failed: [error]"
  - **–ï—Å–ª–∏ CI –Ω–µ—Ç:** Senior Executor –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ –î–û merge, rollback –Ω–µ –Ω—É–∂–µ–Ω
  - Executor –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á—É —Å–Ω–æ–≤–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏

- ‚úÖ **User silence (—Ç–∞–π–º–∞—É—Ç 30 –º–∏–Ω):**
  - Tech Writer —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç draft, –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è
  - –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ: Manager –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–π –≤–æ–ø—Ä–æ—Å user'—É

- ‚úÖ **–ö—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–µ–ª–∏–∑:** Senior Executor
  - –õ–æ–≥–∏—á–Ω–æ–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä–∏–ª ‚Üí –∑–∞–º–µ—Ä–∂–∏–ª ‚Üí CI passed ‚Üí —Ä–µ–ª–∏–∑

- ‚úÖ **–°—Ç–∞—Ç—É—Å—ã –∑–∞–¥–∞—á –≤ beads:**
  - `open` ‚Üí –∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞, –∂–¥—ë—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
  - `in_progress` ‚Üí Executor —Ä–∞–±–æ—Ç–∞–µ—Ç (—á–µ—Ä–µ–∑ `bd update --claim`)
  - `in_progress` + label `needs-review` ‚Üí Executor –∑–∞–∫–æ–Ω—á–∏–ª, –∂–¥—ë—Ç Senior Executor
  - `closed` ‚Üí Senior Executor –∑–∞–º–µ—Ä–∂–∏–ª, CI passed
  - `open` (–≤–æ–∑–≤—Ä–∞—Ç) ‚Üí CI failed –ø–æ—Å–ª–µ merge, –∑–∞–¥–∞—á–∞ –≤–µ—Ä–Ω—É–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π –≤ notes

- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞:**
  - **Bootstrap:** install.sh –∫–æ–ø–∏—Ä—É–µ—Ç `templates/config.template.yaml` ‚Üí `.claudev/config.yaml`
  - Tech Writer –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å config –µ—Å–ª–∏ user —Ö–æ—á–µ—Ç CI/CD
  - –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ä—Ç—É–µ—Ç —Å defaults, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞
  - Defaults:
    ```yaml
    ci: false
    cd: false
    max_parallel_executors: 3
    timeouts:
      task: 10m
      user_input: 30m
    retry_limit: 3
    log_tokens: false
    cleanup:
      enabled: false    # –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ö—Ä–∞–Ω–∏–º –≤—Å—ë
      keep_days: 30     # –µ—Å–ª–∏ enabled: —É–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
    ```
  - **Cleanup** (–µ—Å–ª–∏ enabled): `find logs/archive stats -mtime +$KEEP_DAYS -delete`

- ‚úÖ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–¥–∞—á:**
  - `bd ready` —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (P0 ‚Üí P4)
  - Executor –±–µ—Ä—ë—Ç –ø–µ—Ä–≤—É—é –∏–∑ —Å–ø–∏—Å–∫–∞
  - Manager –ù–ï –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –∑–∞–¥–∞—á–∏ ‚Äî –∏–∑–±—ã—Ç–æ—á–Ω–æ

- ‚úÖ **–ê—Ç–æ–º–∞—Ä–Ω—ã–π claim –∑–∞–¥–∞—á–∏:** (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ bd CLI)
  - Executor –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `bd update <id> --claim`
  - Beads –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å (fails if already claimed)
  - –ï—Å–ª–∏ –∑–∞–Ω—è—Ç–æ ‚Äî Executor –±–µ—Ä—ë—Ç —Å–ª–µ–¥—É—é—â—É—é –∑–∞–¥–∞—á—É
  - Race condition –º–µ–∂–¥—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏ Executors –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω

- ‚úÖ **–õ–∏–º–∏—Ç —ç—Å–∫–∞–ª–∞—Ü–∏–π –∏—Å—á–µ—Ä–ø–∞–Ω:**
  - –ü–æ—Å–ª–µ 2 —ç—Å–∫–∞–ª–∞—Ü–∏–π ‚Üí –∑–∞–¥–∞—á–∞ –ø–æ–ª—É—á–∞–µ—Ç label `blocked:escalation-limit`
  - –í `notes` –∑–∞–¥–∞—á–∏ ‚Äî –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è: —á—Ç–æ –ø—Ä–æ–±–æ–≤–∞–ª–∏, –ø–æ—á–µ–º—É –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å
  - –ó–∞–≤–∏—Å–∏–º–æ–µ –¥–µ—Ä–µ–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è (—á–µ—Ä–µ–∑ deps)
  - –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º –∑–∞–¥–∞—á–∞–º
  - –í —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –æ—Ç—á—ë—Ç–µ ‚Äî —Å–µ–∫—Ü–∏—è "Blocked tasks" —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏

- ‚úÖ **–õ–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏:**
  - –ñ—ë—Å—Ç–∫–æ–≥–æ –ª–∏–º–∏—Ç–∞ –Ω–µ—Ç ‚Äî –±–æ–ª—å—à–æ–π –ø—Ä–æ–µ–∫—Ç –º–æ–∂–µ—Ç –ª–µ–≥–∏—Ç–∏–º–Ω–æ –∑–∞–Ω—è—Ç—å –º–Ω–æ–≥–æ —á–∞—Å–æ–≤
  - –õ–∏–º–∏—Ç—ã —á–µ—Ä–µ–∑ retry/—ç—Å–∫–∞–ª–∞—Ü–∏–∏ —É–∂–µ –∑–∞—â–∏—â–∞—é—Ç –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏—è
  - **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
    - –ö–∞–∂–¥—ã–µ 2h: `log "ORCHESTRATOR" "INFO" "Iteration running for Xh, Y tasks remaining"`
    - –ï—Å–ª–∏ –í–°–ï –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏ blocked: `log "ORCHESTRATOR" "WARN" "All remaining tasks blocked, stopping"` ‚Üí —Å–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
  - User –º–æ–∂–µ—Ç –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

- ‚úÖ **Circular dependencies:**
  - Architect –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á –∑–∞–ø—É—Å–∫–∞–µ—Ç `bd dep cycles`
  - –ï—Å–ª–∏ –µ—Å—Ç—å —Ü–∏–∫–ª—ã ‚Äî –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∞–º
  - Manager –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –≤ IMPLEMENTATION (safety net)

- ‚úÖ **Senior Executor ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π by design:**
  - Quality gate –ø–µ—Ä–µ–¥ main ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å –Ω–µ–ª—å–∑—è (race conditions, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã)
  - –û—á–µ—Ä–µ–¥—å PR = —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ —á–µ–º –º–æ–∂–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ –º–µ—Ä–∂–∏—Ç—å
  - Bottleneck –∑–¥–µ—Å—å ‚Äî —Ñ–∏—á–∞, –Ω–µ –±–∞–≥

- ‚úÖ **Tech Writer ‚Äî –ø–æ–¥—Ö–æ–¥ –∫ SPEC.md:**
  - SPEC.md ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–∏–∞–ª–æ–≥–∞, –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
  - Tech Writer –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞, –∞ –Ω–µ –Ω–∞–æ–±–æ—Ä–æ—Ç
  - **–ï—Å–ª–∏ Architect –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç SPEC.md:**
    - –°–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á—É: `bd create --title="Clarify SPEC.md: <—á—Ç–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ>" --type=task --priority=0`
    - –õ–æ–≥–∏—Ä—É–µ—Ç –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É
    - Manager –≤–∏–¥–∏—Ç P0 ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç Tech Writer
    - Tech Writer —á–∏—Ç–∞–µ—Ç reason, –∑–∞–¥–∞—ë—Ç user —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å
  - **–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
    - –°–ª—É—à–∞–µ—Ç —á—Ç–æ —Ö–æ—á–µ—Ç –∫–ª–∏–µ–Ω—Ç
    - –ó–∞–¥–∞—ë—Ç —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –Ω–µ—è—Å–Ω—ã–º –º–µ—Å—Ç–∞–º
    - –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –∑–Ω–∞–µ—Ç:
      - "–û–±—ã—á–Ω–æ –¥–ª—è —Ç–∞–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç PostgreSQL, –ø–æ–¥–æ–π–¥—ë—Ç?"
      - "–î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–∞—â–µ –≤—Å–µ–≥–æ JWT –∏–ª–∏ —Å–µ—Å—Å–∏–∏. –í–∞–º –≤–∞–∂–Ω–∞ —Ä–∞–∑–Ω–∏—Ü–∞?"
    - –ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤—Å—ë ‚Äî –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –æ—Ç–¥–∞—ë—Ç Architect
  - **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π Architect:**
    - –ù–µ "–µ—Å—Ç—å –ª–∏ —Å–µ–∫—Ü–∏—è X", –∞:
      - –ü–æ–Ω—è—Ç–Ω–æ –ß–¢–û —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –¥–µ–ª–∞—Ç—å?
      - –ü–æ–Ω—è—Ç–Ω–æ –î–õ–Ø –ö–û–ì–û?
      - –ü–æ–Ω—è—Ç–Ω–æ —á—Ç–æ –ú–ò–ù–ò–ú–£–ú –Ω—É–∂–Ω–æ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–ª–∏–∑–∞?
    - –ï—Å–ª–∏ –¥–∞ ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ—Ç –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç
  - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** Architect –ø–æ–ª—É—á–∞–µ—Ç —Ö–æ—Ä–æ—à–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—É—Ç—å, –Ω–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

- ‚úÖ **Beads daemon down:**
  - –°–∏—Å—Ç–µ–º–∞ –ø–∞–¥–∞–µ—Ç, –ø–∏—à–µ—Ç user
  - –ù–µ –ø—ã—Ç–∞–µ–º—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ sync ‚Äî —ç—Ç–æ –ø—É—Ç—å –∫ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö
  - **–ü—Ä–æ–≤–µ—Ä–∫–∞:** Orchestrator –≤—ã–∑—ã–≤–∞–µ—Ç `bd sync --status`
    - –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    - –í —Ü–∏–∫–ª–µ –∫–∞–∂–¥—ã–µ 10 –∏—Ç–µ—Ä–∞—Ü–∏–π (–Ω–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑, —á—Ç–æ–±—ã –Ω–µ –∑–∞–º–µ–¥–ª—è—Ç—å)
  - –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏: `log "ORCHESTRATOR" "FATAL" "Beads daemon not running"` + exit 1

- ‚úÖ **Single instance (lock file):**
  - Orchestrator –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–æ–∑–¥–∞—ë—Ç `.claudev/orchestrator.lock` —Å PID
  - –ï—Å–ª–∏ lock –µ—Å—Ç—å –∏ –ø—Ä–æ—Ü–µ—Å—Å –∂–∏–≤ (`kill -0`) ‚Üí exit "already running"
  - –ï—Å–ª–∏ lock –æ—Ç –º—ë—Ä—Ç–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ ‚Üí stale lock, —É–¥–∞–ª—è–µ–º –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º
  - `trap "rm -f .claudev/orchestrator.lock" EXIT` –¥–ª—è cleanup
  - **Stale lock recovery** (–ø—Ä–∏ SIGKILL trap –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç):
    ```bash
    if [ -f "$LOCK_FILE" ]; then
        OLD_PID=$(cat "$LOCK_FILE")
        if kill -0 "$OLD_PID" 2>/dev/null; then
            echo "Orchestrator already running (PID $OLD_PID)"; exit 1
        else
            echo "Removing stale lock file"; rm -f "$LOCK_FILE"
        fi
    fi
    ```

- ‚úÖ **Merge conflicts (–ø—Ä–æ–º–ø—Ç Senior Executor):**
  - –ú–µ—Ä–∂–∏—Ç—å –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –∑–∞–¥–∞—á (P0 –ø–µ—Ä–≤—ã–º)
  - Pull –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º merge (—Å–≤–µ–∂–∏–π main)
  - –ü—Ä–æ—Å—Ç–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç (—Ä–∞–∑–Ω—ã–µ —Ñ–∞–π–ª—ã/–º–µ—Å—Ç–∞) ‚Äî —Ä–µ—à–∞–µ—Ç —Å–∞–º
  - –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç (–æ–¥–∏–Ω –∫—É—Å–æ–∫ –∫–æ–¥–∞) ‚Äî –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç merge, —Å–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á—É –¥–ª—è Architect

- ‚úÖ **–ü–æ–¥–ø–∏—Å–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
  - –ò—Å–ø–æ–ª—å–∑—É–µ–º Claude Code Max 20x
  - –¢–∞–π–º–∞—É—Ç–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–π
  - –ü–æ—Å–ª–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è `stats/iteration-N.yaml`:
    ```yaml
    tokens:
      total: 125000
      by_role:
        manager: 5000
        tech_writer: 15000
        architect: 25000
        analysts: 30000
        executors: 40000
        senior_executor: 10000
    tasks:
      total: 24
      completed: 22
      blocked: 2
    time:
      start: 2026-01-23T10:00:00
      end: 2026-01-23T12:30:00
    ```

- ‚úÖ **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ñ–∞–∑—ã HELPERS (analysts):**
  - Manager –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–æ–∑–¥–∞—ë—Ç 5 –∑–∞–¥–∞—á-—Ç—Ä–∏–≥–≥–µ—Ä–æ–≤:
    - `run-analyst-ux`, `run-analyst-security`, `run-analyst-ops`, `run-analyst-reliability`, `run-analyst-architecture`
  - –ó–∞–ø—É—Å–∫–∞–µ—Ç 5 –∞–≥–µ–Ω—Ç–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ `timeout 10m`
  - –ö–∞–∂–¥—ã–π analyst: claim —Å–≤–æ–µ–π –∑–∞–¥–∞—á–∏ ‚Üí —Ä–∞–±–æ—Ç–∞ ‚Üí close
  - Manager –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: –≤—Å–µ 5 closed ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –≤ PLAN_REVIEW
  - **Timeout handling:**
    - `timeout` —É–±–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å—à–∏–π –ø—Ä–æ—Ü–µ—Å—Å
    - –ó–∞–¥–∞—á–∞-—Ç—Ä–∏–≥–≥–µ—Ä –æ—Å—Ç–∞—ë—Ç—Å—è open (analyst –Ω–µ —É—Å–ø–µ–ª close)
    - Manager –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ü–∏–∫–ª–µ –≤–∏–¥–∏—Ç: "4 closed, 1 open" ‚Üí –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–≤–∏—Å—à–µ–≥–æ
    - Retry counter –≤ notes –∑–∞–¥–∞—á–∏-—Ç—Ä–∏–≥–≥–µ—Ä–∞
    - –ü–æ—Å–ª–µ 3 retry ‚Üí —ç—Å–∫–∞–ª–∞—Ü–∏—è –∫ Architect

- ‚úÖ **–§–∞–∑–∞ PLAN_REVIEW:**
  - Analysts —Å–æ–∑–¥–∞—é—Ç –∑–∞–¥–∞—á–∏ –ë–ï–ó dependencies (—Ç–æ–ª—å–∫–æ `--label=added-by:analyst-*`)
  - Architect –≤ PLAN_REVIEW —Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ—Ç deps –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
  - Manager —Å–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á—É-—Ç—Ä–∏–≥–≥–µ—Ä `run-plan-review`
  - Architect:
    1. Claim `run-plan-review`
    2. –ù–∞—Ö–æ–¥–∏—Ç –∑–∞–¥–∞—á–∏: `bd list --label=added-by:analyst-*`
    3. –£–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã: `bd close <id> --reason="–î—É–±–ª–∏–∫–∞—Ç claudev-xxx"`
    4. –†–∞–∑—Ä–µ—à–∞–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è: `bd close <id> --reason="–ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç Security: ..."`
    5. Close `run-plan-review`
  - Manager –≤–∏–¥–∏—Ç closed ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –≤ IMPLEMENTATION

- ‚úÖ **–ö–æ–º–º–∏—Ç—ã Executor:**
  - –û–¥–∏–Ω –∫–æ–º–º–∏—Ç –≤ –∫–æ–Ω—Ü–µ —Ä–∞–±–æ—Ç—ã (–ø–µ—Ä–µ–¥ close –∑–∞–¥–∞—á–∏)
  - –ó–∞–¥–∞—á–∏ –∫–æ—Ä–æ—Ç–∫–∏–µ (1-5 –º–∏–Ω), –ø–æ—Ç–µ—Ä—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ = –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
  - Retry 3x –ø–æ–∫—Ä—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ –ø–∞–¥–µ–Ω–∏—è
  - –ù–µ —É—Å–ª–æ–∂–Ω—è–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º–∏ –∫–æ–º–º–∏—Ç–∞–º–∏

- ‚úÖ **Rebase –ø–µ—Ä–µ–¥ push (Executor):**
  - –ü–µ—Ä–µ–¥ push Executor –¥–µ–ª–∞–µ—Ç:
    ```bash
    git fetch origin main
    git rebase origin/main
    git push --force-with-lease -u origin task/beads-xxx
    ```
  - `--force-with-lease` ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ª–∏—á–Ω—É—é –≤–µ—Ç–∫—É –ø—Ä–∏ retry
  - –ü—Ä–æ—Å—Ç–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç (—Ä–∞–∑–Ω—ã–µ —Ñ–∞–π–ª—ã) ‚Äî —Ä–µ—à–∞–µ—Ç —Å–∞–º
  - –°–ª–æ–∂–Ω—ã–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π) ‚Äî —ç—Å–∫–∞–ª–∞—Ü–∏—è –∫ Architect
  - Senior Executor –ø–æ–ª—É—á–∞–µ—Ç —É–∂–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –≤–µ—Ç–∫–∏

- ‚úÖ **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∞–≥–µ–Ω—Ç–æ–≤ (git/gh –æ—à–∏–±–∫–∏):**
  - **–û–±—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –í–°–ï–• –∞–≥–µ–Ω—Ç–æ–≤:**
    - –ü—Ä–∏ –æ—à–∏–±–∫–µ git/gh –∫–æ–º–∞–Ω–¥—ã: –ª–æ–≥–∏—Ä—É–µ–º, –ù–ï –º–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏, –∑–∞–≤–µ—Ä—à–∞–µ–º —Ä–∞–±–æ—Ç—É
    - Manager –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ü–∏–∫–ª–µ
    - –ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –¥–∞—ë—Ç —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  - **Executor –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å):**
    ```bash
    git fetch origin
    git branch -D task/beads-xxx 2>/dev/null  # —É–¥–∞–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –µ—Å–ª–∏ –µ—Å—Ç—å
    git checkout -b task/beads-xxx origin/main
    ```
  - **–ü–æ—Ç–µ—Ä—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏:** –º–∞–∫—Å–∏–º—É–º 1-5 –º–∏–Ω—É—Ç —Ä–∞–±–æ—Ç—ã (–∑–∞–¥–∞—á–∏ –∫–æ—Ä–æ—Ç–∫–∏–µ) ‚Äî –ø—Ä–∏–µ–º–ª–µ–º–æ

- ‚úÖ **–§–∞–∑–∞ FINAL_REVIEW:**
  - Architect –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º
  - –ù–µ –¥—É–±–ª–∏—Ä—É–µ—Ç Senior Executor (—Ç–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–π PR –æ—Ç–¥–µ–ª—å–Ω–æ)
  - **–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
    - –í—Å–µ features –∏–∑ SPEC.md —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã?
    - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–º—É –ø–ª–∞–Ω—É?
    - –ù–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö edge cases?
  - **–ï—Å–ª–∏ –≤—Å—ë –æ–∫:** –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –≤ DONE
  - **–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:** —Å–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á–∏ –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É ‚Üí –æ–±—Ä–∞—Ç–Ω–æ –≤ IMPLEMENTATION

- ‚úÖ **–ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–æ–≤ (—Ñ–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥—ã):**
  ```bash
  # –°—Ç–∞—Ç–∏—á–Ω—ã–π –ø—Ä–æ–º–ø—Ç + –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
  timeout 10m claude --model sonnet --print << EOF
  $(cat .claude/agents/manager.md)

  ---
  PROJECT_ROOT: $(pwd)
  CURRENT_PHASE: $(./scripts/detect-phase.sh)
  EOF
  ```
  - –ü—Ä–æ–º–ø—Ç –∞–≥–µ–Ω—Ç–∞ ‚Äî —Ñ–∞–π–ª (–≤–µ—Ä—Å–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è)
  - –ö–æ–Ω—Ç–µ–∫—Å—Ç ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ —á–µ—Ä–µ–∑ heredoc
  - `--print` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ stdout –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
  - –î–ª—è Executor: –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è `TASK_ID` –∏ `TASK: $(bd show $TASK_ID --format=yaml)`

- ‚úÖ **–ú–æ–¥–µ–ª—å –¥–ª—è Executor:**
  - Architect –Ω–∞–∑–Ω–∞—á–∞–µ—Ç —á–µ—Ä–µ–∑ label: `model:haiku`, `model:sonnet`, `model:opus`
  - run-executors.sh –ø–∞—Ä—Å–∏—Ç: `bd show $TASK_ID --format=json | jq ...`
  - –ï—Å–ª–∏ label –Ω–µ—Ç ‚Üí default `sonnet`

- ‚úÖ **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å vs —Ü–∏–∫–ª orchestrator:**
  - **INIT —Ñ–∞–∑–∞** (Tech Writer) ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º, –±–µ–∑ timeout, stdin/stdout –Ω–∞–ø—Ä—è–º—É—é
  - **–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–∑—ã** ‚Äî –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ä–µ–∂–∏–º, —Å timeout, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã
  - Orchestrator —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–∞—Ö (switch –ø–æ —Ñ–∞–∑–µ)
  - User silence 30min ‚Äî –≤–Ω—É—Ç—Ä–∏ Tech Writer (—Å–∞–º —Å–ª–µ–¥–∏—Ç, –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å draft)

- ‚úÖ **install.sh (cold start, recovery):**
  - Git –Ω–µ—Ç ‚Üí `git init` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  - Remote –Ω–µ—Ç ‚Üí —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç: –¥–æ–±–∞–≤–∏—Ç—å URL –∏–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
  - Beads CLI –Ω–µ—Ç ‚Üí –æ—à–∏–±–∫–∞ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π (–Ω–µ –º–æ–∂–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
  - Beads –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω ‚Üí `bd init` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  - –ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å: —Å–æ–±–∏—Ä–∞–µ–º –≤–æ temp dir, –ø–æ—Ç–æ–º move
  - –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å: –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑–æ–ø–∞—Å–µ–Ω

- ‚úÖ **Graceful shutdown:**
  - `trap cleanup SIGINT SIGTERM` –≤ orchestrator
  - cleanup: SIGTERM –¥–µ—Ç—è–º ‚Üí –∂–¥—ë–º 10s ‚Üí SIGKILL –µ—Å–ª–∏ –∑–∞–≤–∏—Å ‚Üí rm lock
  - –ó–∞–¥–∞—á–∏ `in_progress` –æ—Å—Ç–∞—é—Ç—Å—è ‚Äî —ç—Ç–æ –û–ö
  - –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ orchestrator —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –≤—Å–µ `in_progress` ‚Üí `open` —Å notes "Reset: orchestrator restart"
  - –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ü–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≥–Ω–∞–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç (failure modes, bottlenecks, data flow, edge cases) –∏ –∑–∞–∫—Ä—ã–ª–∏ –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã.

### 1. Draft Tech Writer ‚Äî –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –∑–∞–¥–∞—á–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** User —Ç–∞–π–º-–∞—É—Ç, Tech Writer –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å draft –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è. –ù–æ –∫–∞–∫ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ?

**–†–µ—à–µ–Ω–∏–µ:** `SPEC.draft.md` + –ø—É—Ç—å –≤ notes –∑–∞–¥–∞—á–∏

**Workflow:**
```bash
# Tech Writer –ø—Ä–∏ timeout:
echo "..." > SPEC.draft.md
bd update <task-id> --notes="Draft saved: SPEC.draft.md. Awaiting user input."
bd close <task-id>

# Manager —Å–ª–µ–¥—É—é—â–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è:
if [ -f SPEC.draft.md ] && user_active; then
  bd create --title="Finalize SPEC from draft + user input" --type=task
fi
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Failure: Tech Writer —É–ø–∞–ª ‚Üí draft –≤ —Ñ–∞–π–ª–µ + notes —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø—É—Ç—å
- ‚úÖ Data flow: draft ‚Üí notes ‚Üí Manager ‚Üí new task
- ‚úÖ Edge case: User —É–¥–∞–ª–∏–ª draft ‚Üí –Ω–æ–≤—ã–π Tech Writer –Ω–∞—á–∏–Ω–∞–µ—Ç —Å –Ω—É–ª—è
- ‚úÖ LLM-friendly: –ø—Ä–æ—Å—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã, —è–≤–Ω—ã–π –º–∞—Ä–∫–µ—Ä (—Ñ–∞–π–ª + notes)

---

### 2. Iteration numbering ‚Äî timestamp –≤–º–µ—Å—Ç–æ —Å—á—ë—Ç—á–∏–∫–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** `iteration.txt` —Å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–º ‚Üí crash –º–µ–∂–¥—É –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–º –∏ –∞—Ä—Ö–∏–≤–∞—Ü–∏–µ–π ‚Üí —Å–ª–æ–º–∞–Ω–Ω–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è

**–†–µ—à–µ–Ω–∏–µ:** timestamp –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞, –Ω–∏–∫–∞–∫–æ–≥–æ state file

**Workflow:**
```bash
mv logs/current.log "logs/archive/iteration-$(date +%Y%m%d-%H%M%S).log"
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Failure: crash –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç ‚Üí –Ω–∏—á–µ–≥–æ –Ω–µ —Å–ª–æ–º–∞–µ—Ç—Å—è, timestamp —É–Ω–∏–∫–∞–ª–µ–Ω
- ‚úÖ Bottleneck: –Ω–µ—Ç state file = –Ω–µ—Ç race conditions
- ‚úÖ Data flow: –æ–¥–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è, –∞—Ç–æ–º–∞—Ä–Ω–∞—è
- ‚úÖ Edge case: –¥–≤–∞ mv –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, orchestrator –æ–¥–∏–Ω) ‚Üí —Ä–∞–∑–Ω—ã–µ timestamps
- ‚úÖ LLM-friendly: –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞, –±–µ–∑ –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏

---

### 3. Cleanup ‚Äî —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏ –ø–æ timestamp

**–ü—Ä–æ–±–ª–µ–º–∞:** cleanup –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å—Ç–∞—Ä—Ç–µ orchestrator (iteration_delay=5min) ‚Üí –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –§–°

**–†–µ—à–µ–Ω–∏–µ:** `.claudev/last_cleanup.txt` —Å timestamp, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑ –≤ 24h

**Workflow:**
```bash
LAST=$(cat .claudev/last_cleanup.txt 2>/dev/null || echo 0)
NOW=$(date +%s)
if [ $((NOW - LAST)) -gt 86400 ]; then  # 24 hours
  find logs/archive -mtime +$KEEP_DAYS -delete
  echo $NOW > .claudev/last_cleanup.txt
fi
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Failure: cleanup —É–ø–∞–ª ‚Üí last_cleanup.txt –Ω–µ –æ–±–Ω–æ–≤–∏–ª—Å—è ‚Üí –ø–æ–ø—Ä–æ–±—É–µ—Ç —Å–Ω–æ–≤–∞ (OK)
- ‚úÖ Bottleneck: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏, –Ω–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- ‚úÖ LLM-friendly: –ø—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, –æ–¥–∏–Ω state file

---

### 4. Stats tokens ‚Äî –æ—Ü–µ–Ω–∫–∞ –ø–æ —Ä–∞–∑–º–µ—Ä—É

**–ü—Ä–æ–±–ª–µ–º–∞:** Claude Code –Ω–µ –¥–∞—ë—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Ç–æ–∫–µ–Ω-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —á–µ—Ä–µ–∑ API

**–†–µ—à–µ–Ω–∏–µ:** —Å—á–∏—Ç–∞–µ–º chars, –æ—Ü–µ–Ω–∏–≤–∞–µ–º tokens –∫–∞–∫ `chars / 4`

**Workflow:**
```bash
INPUT_CHARS=$(wc -c < prompts/architect.md)
OUTPUT_CHARS=$(wc -c < output.log)
ESTIMATED_TOKENS=$(( (INPUT_CHARS + OUTPUT_CHARS) / 4 ))

cat > stats/iteration-$TIMESTAMP.yaml <<EOF
iteration_timestamp: "$TIMESTAMP"
agents_run: 12
tasks_completed: 8
estimated_input_chars: $INPUT_CHARS
estimated_output_chars: $OUTPUT_CHARS
estimated_tokens: $ESTIMATED_TOKENS
EOF
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Data flow: chars ‚Üí –æ—Ü–µ–Ω–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ (approximation –ª—É—á—à–µ —á–µ–º –Ω–∏—á–µ–≥–æ)
- ‚úÖ LLM-friendly: –ø—Ä–æ—Å—Ç–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞
- ‚úÖ Future-proof: –º–æ–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–æ–º –ª–æ–≥–æ–≤ –ø–æ–∑–∂–µ

---

### 5. Release timing ‚Äî review+release –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** Release –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Üí review failed ‚Üí –≤–∏—Å—è—á–∞—è release task

**–†–µ—à–µ–Ω–∏–µ:** Senior Executor (Reviewer) –¥–µ–ª–∞–µ—Ç review –ò release –≤ –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–µ

**Workflow:**
```bash
# Manager ‚Üí FINAL_REVIEW:
bd create --title="Review & Release" --type=task --assignee=senior-executor

# Senior Executor:
# 1. Review code
# 2. If PASS:
gh pr create && gh pr merge
bd close <task> --notes="Reviewed & released"
# 3. If FAIL:
bd create <tasks for fixes>
bd close <task> --notes="Review failed, fixes created"
# Manager sees fail ‚Üí phase back to IMPLEMENTATION
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Failure: review failed ‚Üí –Ω–µ—Ç –≤–∏—Å—è—á–µ–π release task
- ‚úÖ Edge case: –Ω–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ LLM-friendly: –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ = review + conditional release
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è: Senior Executor –≤–ª–∞–¥–µ–µ—Ç –≤—Å–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º

---

### 6. PR workflow ‚Äî fail hard –±–µ–∑ remote

**–ü—Ä–æ–±–ª–µ–º–∞:** Local merge –±–µ–∑ PR = no code review, –æ–ø–∞—Å–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å

**–†–µ—à–µ–Ω–∏–µ:** –µ—Å–ª–∏ –Ω–µ—Ç GitHub remote ‚Üí error, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –∂–¥—ë–º User

**Workflow:**
```bash
if ! git remote -v | grep -q github; then
  log "ERROR: No GitHub remote. Cannot auto-release. Manual action required."
  exit 1
fi

gh pr create && gh pr merge
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Edge case: –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç ‚Üí —è–≤–Ω–∞—è –æ—à–∏–±–∫–∞, –Ω–µ silent fail
- ‚úÖ Safety: –Ω–µ –¥–µ–ª–∞–µ–º —Ç–æ —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø–∞—Å–Ω—ã–º (local merge –±–µ–∑ review)
- ‚úÖ LLM-friendly: –ø—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

---

### 7. Config reload ‚Äî –∫–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é

**–ü—Ä–æ–±–ª–µ–º–∞:** config read —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ ‚Üí —Å—Ä–æ—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ iteration_delay (–º–æ–∂–µ—Ç –±—ã—Ç—å 30+ –º–∏–Ω—É—Ç)

**–†–µ—à–µ–Ω–∏–µ:** orchestrator —á–∏—Ç–∞–µ—Ç config –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏

**Workflow:**
```bash
while true; do
  source .claudev/config.yaml  # read fresh config
  log "Iteration started with config: iteration_delay=$ITERATION_DELAY"

  detect_phase
  run_agents

  sleep $ITERATION_DELAY
done
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Data flow: config ‚Üí iteration start ‚Üí –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å—Ä–∞–∑—É
- ‚úÖ –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å: –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–∞–∫—Å–∏–º—É–º —á–µ—Ä–µ–∑ iteration_delay
- ‚úÖ Edge case: —Å—Ä–æ—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Üí User –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç orchestrator –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç
- ‚úÖ LLM-friendly: –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `source`

---

### 8. GitHub remote ‚Äî early detection + graceful degradation

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –Ω–µ—Ç GitHub remote ‚Üí —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–æ Senior Executor ‚Üí –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ merge

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –Ω–∞—á–∞–ª–µ (Manager INIT) + –ª–æ–∫–∞–ª—å–Ω—ã–π merge –∫–∞–∫ fallback

**Workflow:**
```bash
# Manager –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ (INIT —Ñ–∞–∑–∞):
if ! git remote -v | grep -q github; then
  log "WARN" "No GitHub remote detected. Final merge will require manual action."
  bd create --title="Setup GitHub remote for automated PR workflow" \
    --type=task --priority=4 --label=optional
fi

# Senior Executor –ø—Ä–∏ merge:
if ! git remote -v | grep -q github; then
  log "INFO" "No GitHub remote. Performing local merge (no PR review)."
  git checkout main
  git merge --no-ff task/beads-$TASK_ID
  git push || log "WARN" "Cannot push to remote. Manual push required."
else
  gh pr create && gh pr merge
fi
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Failure: User —É–∑–Ω–∞—ë—Ç –æ –ø—Ä–æ–±–ª–µ–º–µ –≤ –Ω–∞—á–∞–ª–µ, –Ω–µ –≤ –∫–æ–Ω—Ü–µ
- ‚úÖ Edge case: –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç (merge –±–µ–∑ PR)
- ‚úÖ LLM-friendly: –ø—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ + if/else
- ‚úÖ Safety: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ P4 –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ remote

---

### 9. Executor rebase conflicts ‚Äî –≤—Å–µ–≥–¥–∞ —ç—Å–∫–∞–ª–∏—Ä–æ–≤–∞—Ç—å

**–ü—Ä–æ–±–ª–µ–º–∞:** LLM –ø–ª–æ—Ö–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç "–ø—Ä–æ—Å—Ç–æ–π vs —Å–ª–æ–∂–Ω—ã–π" –∫–æ–Ω—Ñ–ª–∏–∫—Ç ‚Üí —Ä–∏—Å–∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –õ—é–±–æ–π rebase conflict ‚Üí abort + —ç—Å–∫–∞–ª–∞—Ü–∏—è –∫ Architect

**Workflow:**
```bash
# Executor –ø—Ä–∏ rebase:
git fetch origin main
git rebase origin/main

if [ $? -ne 0 ]; then
  git rebase --abort
  log "WARN" "Rebase conflict detected, escalating to Architect"

  bd update $TASK_ID --status=open \
    --notes="Rebase conflict with main. Files: $(git diff --name-only origin/main...HEAD)"

  bd create --title="Resolve conflict: $TASK_TITLE" \
    --type=task --priority=0 --assignee=architect

  exit 0  # –®—Ç–∞—Ç–Ω–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è, –Ω–µ –æ—à–∏–±–∫–∞
fi

git push --force-with-lease -u origin task/beads-$TASK_ID
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Failure: Executor –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö (–º–µ–Ω—å—à–µ —Ä–∏—Å–∫–∞)
- ‚úÖ LLM-friendly: –ø—Ä–æ—Å—Ç–µ–π—à–∞—è –ª–æ–≥–∏–∫–∞ (failed? ‚Üí abort + escalate)
- ‚úÖ Safety: Architect (Opus) —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –ª—é–±–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç
- ‚úÖ Data flow: –∫–æ–Ω—Ñ–ª–∏–∫—Ç ‚Üí open task ‚Üí P0 –¥–ª—è Architect

---

### 10. Stats tokens ‚Äî –∏–∑–º–µ—Ä—è—Ç—å input, –æ—Ü–µ–Ω–∏–≤–∞—Ç—å output

**–ü—Ä–æ–±–ª–µ–º–∞:** Claude Code output –≤ stdout —Å–º–µ—à–∞–Ω —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ ‚Üí —Å–ª–æ–∂–Ω–æ –ø–∞—Ä—Å–∏—Ç—å —Ç–æ—á–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ—Ä—è—Ç—å input chars, –æ—Ü–µ–Ω–∏–≤–∞—Ç—å output (~50% –æ—Ç input), —Å—á–∏—Ç–∞—Ç—å tokens —á–µ—Ä–µ–∑ `/4`

**Workflow:**
```bash
# Orchestrator –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∞–≥–µ–Ω—Ç–∞:
run_agent() {
  local agent=$1 model=$2 task_id=$3

  # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç –≤–æ temp —Ñ–∞–π–ª
  local prompt_file=".claudev/prompts/${agent}-${task_id}.txt"
  cat ".claude/agents/${agent}.md" > "$prompt_file"
  echo -e "\n---\nTASK_ID: $task_id\n..." >> "$prompt_file"

  # –°—á–∏—Ç–∞–µ–º input
  local input_chars=$(wc -c < "$prompt_file")

  # –ó–∞–ø—É—Å–∫–∞–µ–º (output –≤ –æ–±—â–∏–π –ª–æ–≥)
  {
    echo "=== AGENT START: $agent (task: $task_id) ==="
    timeout 10m claude --model $model --print < "$prompt_file"
    echo "=== AGENT END: $agent ==="
  } | tee -a logs/claudev.log

  # –õ–æ–≥–∏—Ä—É–µ–º stats
  log "STATS" "RUN" "agent=$agent model=$model input_chars=$input_chars task=$task_id"

  rm "$prompt_file"
}

# Stats script (–∫–æ–Ω–µ—Ü –∏—Ç–µ—Ä–∞—Ü–∏–∏):
grep "STATS.*RUN" logs/claudev.log | \
  awk '{
    for(i=1;i<=NF;i++) {
      if($i ~ /input_chars=/) {
        split($i,a,"="); total += a[2]
      }
    }
  } END {
    estimated_output = total * 0.5
    estimated_tokens = (total + estimated_output) / 4
    print "input_chars: " total
    print "estimated_output_chars: " estimated_output
    print "estimated_tokens: " int(estimated_tokens)
  }' > stats/iteration-$(date +%Y%m%d-%H%M%S).yaml
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Data flow: –ø—Ä–æ–º–ø—Ç ‚Üí temp —Ñ–∞–π–ª ‚Üí –∏–∑–º–µ—Ä–µ–Ω–∏–µ ‚Üí –∑–∞–ø—É—Å–∫ ‚Üí cleanup
- ‚úÖ Failure: –ø–∞–¥–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ ‚Üí input –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω (log –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º)
- ‚úÖ LLM-friendly: –ø—Ä–æ—Å—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã (cat, wc, awk)
- ‚úÖ –¢–æ—á–Ω–æ—Å—Ç—å: ~60%, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±—é–¥–∂–µ—Ç–∞ (–Ω–µ billing)

---

### 11. Orchestrator lock ‚Äî atomic —á–µ—Ä–µ–∑ noclobber (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** Race condition –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º —Å—Ç–∞—Ä—Ç–µ ‚Äî –¥–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞—Ç—å lock file –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:** Atomic file creation —á–µ—Ä–µ–∑ `set -C` (noclobber mode)

**Workflow:**
```bash
LOCK_FILE=".claudev/orchestrator.lock"

# Atomic lock: noclobber fails –µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
if ! (set -C; echo $$ > "$LOCK_FILE") 2>/dev/null; then
    # Lock exists, check if stale
    OLD_PID=$(cat "$LOCK_FILE" 2>/dev/null || echo "0")
    if kill -0 "$OLD_PID" 2>/dev/null; then
        echo "Orchestrator already running (PID $OLD_PID)"
        exit 1
    else
        echo "Removing stale lock (PID $OLD_PID not found)"
        rm -f "$LOCK_FILE"
        # Retry once
        if ! (set -C; echo $$ > "$LOCK_FILE") 2>/dev/null; then
            echo "Failed to acquire lock (race with another process?)"
            exit 1
        fi
    fi
fi

trap "rm -f '$LOCK_FILE'" EXIT
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Race condition –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω (atomic FS operation)
- ‚úÖ Stale lock detection (kill -0 –ø—Ä–æ–≤–µ—Ä–∫–∞)
- ‚úÖ Graceful cleanup (trap EXIT)
- ‚úÖ LLM-friendly: –ø—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞

---

### 12. Config ‚Äî bash –Ω–∞–ø—Ä—è–º—É—é (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** YAML parsing —Å–ª–æ–∂–µ–Ω, race conditions —Å timestamp, –Ω—É–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –û—Ç–∫–∞–∑ –æ—Ç YAML, config.sh –Ω–∞–ø—Ä—è–º—É—é (bash syntax)

**Workflow:**
```bash
# .claudev/config.sh (User —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç –Ω–∞–ø—Ä—è–º—É—é)
CI_ENABLED=false
CD_ENABLED=false
MAX_PARALLEL_EXECUTORS=3
TASK_TIMEOUT="10m"
USER_INPUT_TIMEOUT="30m"
RETRY_LIMIT=3
LOG_TOKENS=false
CLEANUP_ENABLED=false
CLEANUP_KEEP_DAYS=30

# Orchestrator –ø—Ä–æ—Å—Ç–æ source:
source .claudev/config.sh
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ –ù–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ (–º–µ–Ω—å—à–µ –∫–æ–¥–∞, –º–µ–Ω—å—à–µ –±–∞–≥–æ–≤)
- ‚úÖ –ù–µ—Ç race conditions (–∞—Ç–æ–º–∞—Ä–Ω—ã–π read)
- ‚úÖ User-friendly (bash —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø—Ä–æ—Å—Ç–æ–π, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Ñ–∞–π–ª–µ)
- ‚úÖ Reload –∫–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é –±–µ–∑ –¥–æ–ø. –ª–æ–≥–∏–∫–∏

---

### 13. GitHub check ‚Äî —á–µ—Ä–µ–∑ gh CLI —Å fallback (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** `grep github` –Ω–µ –ª–æ–≤–∏—Ç enterprise/custom domains, —á—Ç–æ –µ—Å–ª–∏ gh CLI –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω?

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ gh CLI + graceful fallback –∫ local merge

**Workflow:**
```bash
# –•–µ–ª–ø–µ—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
check_github_pr_available() {
    command -v gh &>/dev/null && gh auth status &>/dev/null
}

# Senior Executor –ø—Ä–∏ merge:
if check_github_pr_available; then
    gh pr create --fill
    gh pr merge --squash --auto
else
    log "INFO" "No gh CLI or not authenticated, performing local merge"
    git checkout main
    git merge --no-ff "task/beads-$TASK_ID"
    git push 2>/dev/null || log "WARN" "Cannot push (no remote or no access)"
fi
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ –õ–æ–≤–∏—Ç –ª—é–±—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã GitHub (enterprise, custom)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ gh CLI + –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- ‚úÖ Graceful degradation (local merge –µ—Å–ª–∏ gh –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
- ‚úÖ LLM-friendly: –ø—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è-—Ö–µ–ª–ø–µ—Ä

---

### 14. Beads daemon ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–µ–¥–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–∫–∞–∂–¥—ã–µ 10 –∏—Ç–µ—Ä–∞—Ü–∏–π) ‚Üí daemon —É–ø–∞–ª ‚Üí —Ä–∞–±–æ—Ç–∞–µ–º –±–µ–∑ sync ‚Üí data loss

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –Ω–∞—á–∞–ª–µ –ö–ê–ñ–î–û–ô –∏—Ç–µ—Ä–∞—Ü–∏–∏ (–¥—ë—à–µ–≤–æ, –∫—Ä–∏—Ç–∏—á–Ω–æ)

**Workflow:**
```bash
while true; do
    # 1. Check daemon (fast, ~10-50ms)
    if ! bd sync --status &>/dev/null; then
        log "FATAL" "Beads daemon not running. Run: bd daemon start"
        exit 1
    fi

    # 2. Load config
    source .claudev/config.sh

    # 3. Detect phase & run agents
    ...

    sleep "$ITERATION_DELAY"
done
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Fail fast (–∑–∞—â–∏—Ç–∞ –æ—Ç data loss)
- ‚úÖ –î—ë—à–µ–≤–æ (~10-50ms overhead)
- ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω–æ (sync –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏)

---

### 15. Executor rebase ‚Äî WIP commit –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏ (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** Conflict ‚Üí abort ‚Üí –≤—Å—è —Ä–∞–±–æ—Ç–∞ –ø–æ—Ç–µ—Ä—è–Ω–∞ (–∑–∞–¥–∞—á–∏ –º–∞–ª–µ–Ω—å–∫–∏–µ, –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—è –Ω–µ –ø–æ–º–µ—à–∞–µ—Ç)

**–†–µ—à–µ–Ω–∏–µ:** WIP commit –ø–µ—Ä–µ–¥ rebase + squash –≤ –∫–æ–Ω—Ü–µ (clean history)

**Workflow:**
```bash
# 1. WIP commit (—Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–∞–±–æ—Ç—É)
git add -A
git commit -m "WIP: task-$TASK_ID (pre-rebase)"

# 2. Rebase
git fetch origin main
if ! git rebase origin/main; then
    # Conflict detected
    git rebase --abort

    log "WARN" "Rebase conflict, escalating to Architect"

    # –†–∞–±–æ—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ WIP commit, –º–æ–∂–Ω–æ push
    git push --force-with-lease -u origin "task/beads-$TASK_ID"

    # –≠—Å–∫–∞–ª–∞—Ü–∏—è
    bd create --title="Resolve rebase conflict: $TASK_TITLE" \
        --type=task --priority=0 --assignee=architect \
        --notes="Branch: task/beads-$TASK_ID, conflicts with main"

    bd update "$TASK_ID" --status=blocked --label=needs-rebase
    exit 0
fi

# 3. Squash WIP commit (clean history)
git reset --soft HEAD~1
git commit -m "$COMMIT_MESSAGE"
git push --force-with-lease -u origin "task/beads-$TASK_ID"

bd update "$TASK_ID" --label=needs-review
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ –†–∞–±–æ—Ç–∞ –ù–ò–ö–û–ì–î–ê –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è (WIP commit)
- ‚úÖ Clean history –≤ –∏—Ç–æ–≥–µ (squash –ø–µ—Ä–µ–¥ push)
- ‚úÖ Architect –ø–æ–ª—É—á–∞–µ—Ç –≤–µ—Ç–∫—É —Å —Ä–∞–±–æ—Ç–æ–π
- ‚úÖ –ù–µ —É—Å–ª–æ–∂–Ω—è–µ—Ç (~5 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞)

---

### 16. Executors backpressure ‚Äî –ª–∏–º–∏—Ç open PR (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** Executors —Å–æ–∑–¥–∞—é—Ç PR –±—ã—Å—Ç—Ä–µ–µ —á–µ–º Senior Executor –º–µ—Ä–∂–∏—Ç ‚Üí –æ—á–µ—Ä–µ–¥—å —Ä–∞—Å—Ç—ë—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:** Queue limit —á–µ—Ä–µ–∑ MAX_PARALLEL_EXECUTORS

**Workflow:**
```bash
# run-executors.sh –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:
OPEN_PRS=$(gh pr list --state open --json number --jq 'length' 2>/dev/null || echo 0)

if [ "$OPEN_PRS" -ge "$MAX_PARALLEL_EXECUTORS" ]; then
    log "INFO" "PR queue full ($OPEN_PRS/$MAX_PARALLEL_EXECUTORS), waiting"
    exit 0
fi

# –ò–Ω–∞—á–µ –∑–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã—Ö Executors
...
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Natural flow control (Senior Executor –º–µ—Ä–∂–∏—Ç ‚Üí —Å–ª–æ—Ç –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è)
- ‚úÖ Bottleneck —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ LLM-friendly: –ø—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

---

### 17. Stats tokens ‚Äî –ø—Ä–æ—Å—Ç–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** Claude Code –Ω–µ –¥–∞—ë—Ç —Ç–æ—á–Ω—É—é —Ç–æ–∫–µ–Ω-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –Ω—É–∂–Ω–∞ —Ö–æ—Ç—è –±—ã –æ—Ü–µ–Ω–∫–∞

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Å—á—ë—Ç chars ‚Üí tokens (–¥–ª—è info, –Ω–µ –¥–ª—è billing)

**Workflow:**
```bash
# Orchestrator –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∞–≥–µ–Ω—Ç–∞:
run_agent() {
    local prompt_file=".claudev/prompts/${agent}-${task_id}.txt"

    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç
    cat ".claude/agents/${agent}.md" > "$prompt_file"
    echo -e "\n---\nTASK_ID: $task_id\n..." >> "$prompt_file"

    # –°—á–∏—Ç–∞–µ–º input
    local input_chars=$(wc -c < "$prompt_file")
    local estimated_tokens=$((input_chars / 4))

    # –ó–∞–ø—É—Å–∫–∞–µ–º
    timeout 10m claude --model $model --print < "$prompt_file" | tee -a logs/claudev.log

    # –õ–æ–≥–∏—Ä—É–µ–º stats
    echo "$agent,$input_chars,$estimated_tokens" >> stats/current-iteration.csv

    rm "$prompt_file"
}
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –æ—Ü–µ–Ω–∫–∞ (–ø—Ä–∏–º–µ—Ä–Ω–∞—è, –Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)
- ‚úÖ CSV –¥–ª—è –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ LLM-friendly: –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ wc

---

### 18. Graceful shutdown ‚Äî smart reset (5min threshold) (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ `in_progress` ‚Üí –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –µ—Å–ª–∏ –∞–≥–µ–Ω—Ç —É—Å–ø–µ–ª close –Ω–æ –º—ã –Ω–µ —É–≤–∏–¥–µ–ª–∏

**–†–µ—à–µ–Ω–∏–µ:** Reset —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á (>5min), —Å–≤–µ–∂–∏–µ –æ—Å—Ç–∞–≤–ª—è–µ–º

**Workflow:**
```bash
cleanup() {
    log "INFO" "Shutting down gracefully..."

    # SIGTERM –¥–µ—Ç—è–º (–¥–∞—ë–º –≤—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è)
    pkill -P $$ -TERM
    sleep 5
    pkill -P $$ -KILL 2>/dev/null

    # Reset —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á (>5min in_progress)
    for task_id in $(bd list --status=in_progress --format=json | jq -r '.[].id'); do
        claimed_ts=$(bd show "$task_id" --format=json | jq -r '.updated_at')
        claimed_epoch=$(date -j -f "%Y-%m-%dT%H:%M:%S" "$claimed_ts" +%s 2>/dev/null || date -d "$claimed_ts" +%s)
        now_epoch=$(date +%s)
        age=$((now_epoch - claimed_epoch))

        if [ "$age" -gt 300 ]; then  # 5 minutes
            log "INFO" "Resetting stale task $task_id (age: ${age}s)"
            bd update "$task_id" --status=open --notes="Reset: stale at shutdown (${age}s old)"
        else
            log "INFO" "Keeping recent task $task_id (age: ${age}s)"
        fi
    done

    rm -f "$LOCK_FILE"
    exit 0
}

trap cleanup SIGINT SIGTERM
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ –°–≤–µ–∂–∏–µ –∑–∞–¥–∞—á–∏ (<5min) –Ω–µ —Ç—Ä–æ–≥–∞–µ–º
- ‚úÖ –°—Ç–∞—Ä—ã–µ –∑–∞–¥–∞—á–∏ (>5min) —Å–±—Ä–∞—Å—ã–≤–∞–µ–º
- ‚úÖ Minimal duplication

---

### 19. Tech Writer draft ‚Äî TTL 24h (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** Draft —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç (user –≤–µ—Ä–Ω—É–ª—Å—è —á–µ—Ä–µ–∑ 2 –Ω–µ–¥–µ–ª–∏), –Ω–æ Manager –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å

**–†–µ—à–µ–Ω–∏–µ:** TTL 24h + –∞—Ä—Ö–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö drafts

**Workflow:**
```bash
# Manager –ø—Ä–∏ INIT —Ñ–∞–∑–µ:
if [ -f SPEC.draft.md ]; then
    draft_age=$(( $(date +%s) - $(stat -f %m SPEC.draft.md 2>/dev/null || stat -c %Y SPEC.draft.md) ))

    if [ "$draft_age" -gt 86400 ]; then
        # Draft >24h old
        log "INFO" "Found old draft (${draft_age}s old), archiving"
        mv SPEC.draft.md "SPEC.draft.$(date +%Y%m%d).old"

        # Start fresh
        bd create --title="Gather requirements (fresh start)" \
            --type=task --assignee=tech-writer --priority=0
    else
        # Draft fresh, continue
        bd create --title="Finalize SPEC from draft" \
            --type=task --assignee=tech-writer --priority=0 \
            --notes="Continue from SPEC.draft.md"
    fi
fi
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ 24h TTL (—Ä–∞–∑—É–º–Ω—ã–π –±–∞–ª–∞–Ω—Å)
- ‚úÖ –°—Ç–∞—Ä—ã–π draft –∞—Ä—Ö–∏–≤–∏—Ä—É–µ—Ç—Å—è (–Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è)
- ‚úÖ User –≤–∏–¥–∏—Ç —á—Ç–æ –Ω–∞—á–∞–ª–æ—Å—å –∑–∞–Ω–æ–≤–æ

---

### 20. Circular dependencies ‚Äî check –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ add (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** Architect –¥–æ–±–∞–≤–ª—è–µ—Ç deps –ø–∞—á–∫–æ–π ‚Üí —Ü–∏–∫–ª –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è –ø–æ–∑–¥–Ω–æ, —Å–ª–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å

**–†–µ—à–µ–Ω–∏–µ:** –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤ –ø—Ä–æ–º–ø—Ç–µ ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ö–ê–ñ–î–û–ô –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ü—Ä–æ–º–ø—Ç Architect (—Å–µ–∫—Ü–∏—è dependencies):**
```markdown
## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ö–†–ò–¢–ò–ß–ù–û:** –ü—Ä–æ–≤–µ—Ä—è–π cycles –ü–û–°–õ–ï –ö–ê–ñ–î–û–ô –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
# –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã:
bd dep add <task-id> <depends-on-id>

# –°–†–ê–ó–£ –ø—Ä–æ–≤–µ—Ä—è–µ–º
if bd dep cycles 2>&1 | grep -q "cycle"; then
    echo "ERROR: Cycle detected with last dependency"
    bd dep remove <task-id> <depends-on-id>
    # –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–∏ dependency graph
fi
```

**–ï—Å–ª–∏ cycles detection failed –ø–æ—Å–ª–µ –≤—Å–µ—Ö deps:**
1. –í—ã–≤–µ–¥–∏ –≥—Ä–∞—Ñ: `bd dep graph`
2. –ù–∞–π–¥–∏ —Ü–∏–∫–ª –≤—Ä—É—á–Ω—É—é
3. –£–¥–∞–ª–∏ –æ–¥–Ω—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏–∑ —Ü–∏–∫–ª–∞
4. –ó–∞–ª–æ–≥–∏—Ä—É–π: –ø–æ—á–µ–º—É —É–¥–∞–ª–∏–ª –∏–º–µ–Ω–Ω–æ —ç—Ç—É
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ–º —Ü–∏–∫–ª —Å—Ä–∞–∑—É (easy rollback)
- ‚úÖ Architect –∑–Ω–∞–µ—Ç –∫–∞–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å–æ–∑–¥–∞–ª–∞ –ø—Ä–æ–±–ª–µ–º—É
- ‚úÖ LLM-friendly (–ø—Ä–æ—Å—Ç–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è)

---

### 21. Iteration lock concept ‚Äî –æ–¥–Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è –∑–∞ —Ä–∞–∑ (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** Timestamp collision –≤ logs, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç —Å–ª–æ–º–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:** –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ: –æ–¥–Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è = –æ–¥–∏–Ω orchestrator –ø—Ä–æ—Ü–µ—Å—Å = –æ–¥–∏–Ω lock file

**–ì–∞—Ä–∞–Ω—Ç–∏–∏:**
- Orchestrator.lock (—Ä–µ—à–µ–Ω–∏–µ #11) —É–∂–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞
- –û–¥–Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è = –æ—Ç —Å—Ç–∞—Ä—Ç–∞ orchestrator –¥–æ —Ñ–∞–∑—ã DONE (–∏–ª–∏ stop)
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã (atomic lock)
- Timestamp –≤ logs = –≤—Ä–µ–º—è –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏, –Ω–µ –Ω—É–º–µ—Ä–∞—Ü–∏—è –∏—Ç–µ—Ä–∞—Ü–∏–π

**Workflow:**
```bash
# Orchestrator lock —É–∂–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
# –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏ (—Ñ–∞–∑–∞ DONE):
mv logs/claudev.log "logs/archive/iteration-$(date +%Y%m%d-%H%M%S).log"
mv stats/current-iteration.md "stats/iteration-$(date +%Y%m%d-%H%M%S).md"
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã (lock file)
- ‚úÖ Timestamp collision –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω (–æ–¥–Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è –∑–∞ —Ä–∞–∑)
- ‚úÖ –ö–∞–∂–¥–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è = –æ–¥–∏–Ω —Ä–µ–ª–∏–∑

---

### 22. Stats format ‚Äî Markdown –≤–º–µ—Å—Ç–æ CSV (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** CSV –±–µ–∑ header, —Å–ª–æ–∂–Ω–æ —á–∏—Ç–∞—Ç—å, –Ω–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:** Markdown report —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏

**Workflow:**
```bash
# stats/iteration-TIMESTAMP.md
cat > stats/iteration-$(date +%Y%m%d-%H%M%S).md <<EOF
# Iteration Report

**Started:** $(cat .claudev/iteration_start.txt)
**Completed:** $(date '+%Y-%m-%d %H:%M:%S')
**Duration:** $(calculate_duration)

## Tasks
- Total created: $(bd list --format=json | jq 'length')
- Completed: $(bd list --status=closed --format=json | jq 'length')
- Blocked: $(bd list --label=blocked --format=json | jq 'length')

## Agents Activity
| Agent | Runs | Est. tokens |
|-------|------|-------------|
$(generate_agent_stats)

## Blocked Tasks
$(bd list --label=blocked --format=json | jq -r '.[] | "- \`\(.id)\`: \(.title) (reason: \(.notes))"')
EOF
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ –ß–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç (markdown)
- ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç (–≤—Ä–µ–º—è, duration, summary)
- ‚úÖ –õ–µ–≥–∫–æ –ø–∞—Ä—Å–∏—Ç—å –¥–ª—è –º–µ—Ç—Ä–∏–∫ (jq –∏–∑ json source)

---

### 23. Retry counter ‚Äî label –≤–º–µ—Å—Ç–æ notes parsing (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** Retry –≤ notes –∫–∞–∫ —Ç–µ–∫—Å—Ç ‚Üí —Ö—Ä—É–ø–∫–∏–π regex parsing

**–†–µ—à–µ–Ω–∏–µ:** Label `retry:N` (–∞—Ç–æ–º–∞—Ä–Ω–æ, –ª–µ–≥–∫–æ –ø–∞—Ä—Å–∏—Ç—å)

**Workflow:**
```bash
# Executor –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–µ:
bd update $TASK_ID --status=in_progress --label=retry:0

# Orchestrator –ø—Ä–∏ retry:
CURRENT_RETRY=$(bd show $TASK_ID --format=json | jq -r '.labels[] | select(startswith("retry:")) | split(":")[1]')
NEW_RETRY=$((CURRENT_RETRY + 1))

if [ "$NEW_RETRY" -ge "$RETRY_LIMIT" ]; then
    # –≠—Å–∫–∞–ª–∞—Ü–∏—è –∫ Architect
    bd create --title="Escalation: $TASK_TITLE failed after $RETRY_LIMIT retries" \
        --type=task --priority=0 --assignee=architect
    bd update $TASK_ID --label=blocked:escalation-limit
else
    # Retry
    bd update $TASK_ID --status=open --label=retry:$NEW_RETRY
fi
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ –ê—Ç–æ–º–∞—Ä–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (beads label)
- ‚úÖ –õ–µ–≥–∫–æ –ø–∞—Ä—Å–∏—Ç—å (jq select)
- ‚úÖ –í–∏–¥–Ω–æ –≤ bd list (label –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è)

---

### 24. Install.sh ‚Äî dependency checker + auto-install (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** Pre-commit hook fails –µ—Å–ª–∏ gitleaks –Ω–µ—Ç, gh workflow fails –µ—Å–ª–∏ gh –Ω–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:** Check all deps –ø—Ä–∏ install, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ auto-install

**Workflow:**
```bash
#!/bin/bash
check_deps() {
    local missing=()

    command -v bd &>/dev/null || missing+=("beads")
    command -v gh &>/dev/null || missing+=("gh")
    command -v gitleaks &>/dev/null || missing+=("gitleaks")
    command -v claude &>/dev/null || missing+=("claude-code")

    if [ ${#missing[@]} -gt 0 ]; then
        echo "Missing dependencies: ${missing[*]}"
        echo ""
        echo "Install commands:"
        [[ " ${missing[*]} " =~ " beads " ]] && echo "  npm install -g @beadsland/beads"
        [[ " ${missing[*]} " =~ " gh " ]] && echo "  brew install gh  # or: apt install gh"
        [[ " ${missing[*]} " =~ " gitleaks " ]] && echo "  brew install gitleaks  # optional (security)"
        [[ " ${missing[*]} " =~ " claude-code " ]] && echo "  npm install -g @anthropic/claude-code"
        echo ""

        if [ "$AUTO_INSTALL" = "true" ]; then
            echo "Auto-installing npm packages..."
            [[ " ${missing[*]} " =~ " beads " ]] && npm install -g @beadsland/beads
            [[ " ${missing[*]} " =~ " claude-code " ]] && npm install -g @anthropic/claude-code
            echo "Note: gh and gitleaks require manual install (brew/apt)"
        else
            echo "Run with --auto-install to install npm packages automatically"
            exit 1
        fi
    fi
}

# Usage: ./install.sh [--auto-install]
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ deps (beads, claude, gh, gitleaks)
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ auto-install npm –ø–∞–∫–µ—Ç–æ–≤ (–±–µ–∑–æ–ø–∞—Å–Ω–æ)
- ‚úÖ Pre-commit hook –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ gitleaks —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

---

### 25. SPEC.draft.md cleanup ‚Äî mv –ø—Ä–∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ (FINAL)

**–ü—Ä–æ–±–ª–µ–º–∞:** Tech Writer —Å–æ–∑–¥–∞—ë—Ç draft, –∫—Ç–æ —É–¥–∞–ª—è–µ—Ç –ø–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏?

**–†–µ—à–µ–Ω–∏–µ:** Tech Writer –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç

**Workflow:**
```bash
# Tech Writer –ø—Ä–∏ timeout (30min):
cat > SPEC.draft.md <<EOF
# [WIP] Project Spec
... (—á—Ç–æ —É—Å–ø–µ–ª —Å–æ–±—Ä–∞—Ç—å)
EOF
bd update $TASK_ID --notes="Draft saved: SPEC.draft.md, awaiting user input"
bd close $TASK_ID

# Tech Writer –ø—Ä–∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ (user –≤–µ—Ä–Ω—É–ª—Å—è):
# 1. –ß–∏—Ç–∞–µ—Ç draft
# 2. –ó–∞–¥–∞—ë—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –≤–æ–ø—Ä–æ—Å—ã
# 3. –§–∏–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç:
mv SPEC.draft.md SPEC.md  # –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º draft ‚Üí final
bd close $TASK_ID --notes="SPEC finalized from draft"
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- ‚úÖ Draft –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è final (–Ω–µ –Ω—É–∂–µ–Ω cleanup)
- ‚úÖ TTL 24h (—Ä–µ—à–µ–Ω–∏–µ #19) –¥–ª—è —Å—Ç–∞—Ä—ã—Ö drafts
- ‚úÖ –ù–µ—Ç orphaned files

---

## –ò—Ç–æ–≥–∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞ (23-24 —è–Ω–≤–∞—Ä—è 2026)

**–ü—Ä–æ–≤–µ–¥–µ–Ω–æ –¥–≤–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∞—É–¥–∏—Ç–∞ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.**

### –ü–µ—Ä–≤–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ (23 —è–Ω–≤–∞—Ä—è): 10 —É–≥—Ä–æ–∑

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ (data loss, race conditions): 4**
1. ‚úÖ Orchestrator lock race condition ‚Üí –†–µ—à–µ–Ω–∏–µ #11: atomic —á–µ—Ä–µ–∑ `set -C`
2. ‚úÖ Config sync race condition ‚Üí –†–µ—à–µ–Ω–∏–µ #12: bash config –Ω–∞–ø—Ä—è–º—É—é (–æ—Ç–∫–∞–∑ –æ—Ç YAML)
3. ‚úÖ Executor rebase –ø–æ—Ç–µ—Ä—è —Ä–∞–±–æ—Ç—ã ‚Üí –†–µ—à–µ–Ω–∏–µ #15: WIP commit –ø–µ—Ä–µ–¥ rebase
4. ‚úÖ Graceful shutdown lost in-progress ‚Üí –†–µ—à–µ–Ω–∏–µ #18: smart reset (5min threshold)

**–°—Ä–µ–¥–Ω–∏–µ (–Ω–µ—Ç–æ—á–Ω–æ—Å—Ç—å, edge cases): 6**
5. ‚úÖ GitHub remote detection fragile ‚Üí –†–µ—à–µ–Ω–∏–µ #13: –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ gh CLI + fallback
6. ‚úÖ Beads daemon check –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ ‚Üí –†–µ—à–µ–Ω–∏–µ #14: –∫–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é
7. ‚úÖ Senior Executor backpressure –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí –†–µ—à–µ–Ω–∏–µ #16: queue limit —á–µ—Ä–µ–∑ MAX_PARALLEL_EXECUTORS
8. ‚úÖ Stats tokens –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç—å ‚Üí –†–µ—à–µ–Ω–∏–µ #17: –ø—Ä–æ—Å—Ç–∞—è –æ—Ü–µ–Ω–∫–∞ (chars/4), –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
9. ‚úÖ Tech Writer draft orphaned ‚Üí –†–µ—à–µ–Ω–∏–µ #19: TTL 24h + –∞—Ä—Ö–∏–≤–∞—Ü–∏—è
10. ‚úÖ Circular deps false positive ‚Üí –†–µ—à–µ–Ω–∏–µ #20: check –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ dep add

### –í—Ç–æ—Ä–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ (24 —è–Ω–≤–∞—Ä—è): 9 —É–≥—Ä–æ–∑

**–ë–ª–æ–∫–µ—Ä—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (P0): 2**
1. ‚ö†Ô∏è Config validation –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí [claudev-czh](claudev-czh) ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Å–ª–µ source (–†–ï–ê–õ–¨–ù–ê–Ø: typo ‚Üí crash)
2. ‚ö†Ô∏è Backpressure –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ gh CLI ‚Üí [claudev-acs](claudev-acs) ‚Äî —Å—á—ë—Ç —á–µ—Ä–µ–∑ beads (–†–ï–ê–õ–¨–ù–ê–Ø: –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ –±–µ–∑ gh)

**–í–∞–∂–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ (P1, –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç): 2**
3. üìã Race: executors —Å—Ç–∞—Ä—Ç—É—é—Ç –¥–æ PLAN_REVIEW ‚Üí [claudev-ssb](claudev-ssb) ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ run-plan-review (–¢–ï–û–†–ï–¢–ò–ß–ï–°–ö–ê–Ø: –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ)
4. üìã Manager cycles check –Ω–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ ‚Üí [claudev-h03](claudev-h03) ‚Äî P0 task –ø—Ä–∏ cycles (NICE TO HAVE: Architect —É–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç)

**–†–µ—à–µ–Ω–∏—è –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: 5**
5. ‚úÖ Iteration lock concept ‚Üí –†–µ—à–µ–Ω–∏–µ #21: –æ–¥–Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è –∑–∞ —Ä–∞–∑ (—É–∂–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–æ lock file)
6. ‚úÖ Stats format —É–ª—É—á—à–µ–Ω–∏–µ ‚Üí –†–µ—à–µ–Ω–∏–µ #22: Markdown –≤–º–µ—Å—Ç–æ CSV
7. ‚úÖ Retry counter —Ö—Ä—É–ø–∫–∏–π parsing ‚Üí –†–µ—à–µ–Ω–∏–µ #23: label `retry:N`
8. ‚úÖ Install.sh missing deps ‚Üí –†–µ—à–µ–Ω–∏–µ #24: dependency checker + auto-install
9. ‚úÖ SPEC.draft.md cleanup ‚Üí –†–µ—à–µ–Ω–∏–µ #25: mv –ø—Ä–∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏

### –ò—Ç–æ–≥–æ: 19 —É–≥—Ä–æ–∑ –Ω–∞–π–¥–µ–Ω–æ –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ

**–ò–∑ –Ω–∏—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –±–ª–æ–∫–µ—Ä–æ–≤:** 2 (10%)
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º:** <10% (edge cases –ø—Ä–∏–µ–º–ª–µ–º—ã –¥–ª—è MVP)

**–û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –≤—Å–µ—Ö —Ä–µ—à–µ–Ω–∏–π:**
- –°–ª–µ–¥—É—é—Ç –ø—Ä–∏–Ω—Ü–∏–ø—É –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- LLM-friendly (–ø—Ä–æ—Å—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã, —á—ë—Ç–∫–∞—è –ª–æ–≥–∏–∫–∞)
- –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- Graceful degradation –≥–¥–µ –Ω—É–∂–Ω–æ
- Fail fast –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö

**–í—ã–≤–æ–¥:** –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è 2 P0 –∑–∞–¥–∞—á ‚Äî –≥–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. P1 –∑–∞–¥–∞—á–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ.

---

**–û—Ç–ª–æ–∂–µ–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏:**
- [ ] OS Notifications (macOS/Linux)
- [ ] Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Telegram, Slack)
- [ ] –ê–≤—Ç–æ–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (README, API docs)
